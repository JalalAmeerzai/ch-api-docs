# Media Metadata Object Model

## Overview

**Current version:** 0.0.5

**Logs:**

- 2020-01-07: **Added** `guid` and `additional_formats` keys for AWS Elemental MediaConvert (these are not editable by the API). 
- 2019-12-10: **Updated** the `product_sku` type to be correct and and added an option.
- 2019-11-14: **Updated** media types and examples to match.
- 2019-11-05: **Updated** media types and examples to match.
- 2019-10-21: **Added** a number of data points and updated the descriptions and examples.
- 2019-07-16: [Major Change!] Changed the structure of the data. Changed `updated_at` to `last_modified`.
- 2019-07-01: Created.

## Purpose

The Media Metadata Object Model is the representation of the metadata surrounding a digital product. It holds all the necessary data for those products in relation to the product and business needs. This service will need business logic to create signed AWS S3 links.

## Definitions

- `product_sku` _(string)_: The product's unique SKU.
- `file_data` _(array of objects)_: The data for each media file defined as _(**NOTE:** index number does not mean anything)_:
	- `title` _(string)_: The title of the media object.
	- `media_type` _(string)_: The type of media _(**NOTE:** this list might grow/change)_:
		- `MEDIA_TYPE_UNKNOWN`  _(default)_
		- **Audio Options** &darr;
		- `MEDIA_TYPE_MP3`
		- `MEDIA_TYPE_M4A`
		- **Video Options** &darr;
		- `MEDIA_TYPE_MP4`
		- **Ebook Options** &darr;
		- `MEDIA_TYPE_EPUB`
		- `MEDIA_TYPE_MOBI`
		- `MEDIA_TYPE_JPG`
		- **Common Options** &darr;
		- `MEDIA_TYPE_PDF`
		- `MEDIA_TYPE_ZIP`
	- `media_s3_bucket` _(string)_: The bucket of the product inside of S3 (e.g. "soundstrue-downloads")
	- `media_s3_key` _(string)_: The location (including filename) of the product inside of S3 (e.g. "products/SomaticDescent_AF04734W/Reginald_A_Ray-Somatic_Descent-0101.mp3").
	- `duration` _(int)_: [audio/video only] Total running time of audio or video file in Seconds (e.g. 14400 = 4h).
	- `total_pages` _(int)_: [eBook only] Total number of pages for an ebook.
	- `file_size` _(string)_: The size of the file (e.g. "745.20 MB").
	- `sort_order` _(int)_: The ordering, starting at `1`, of the object for the particular product (e.g. 10).
	- (read-only) `guid` _(string)_: MediaConvert Service GUID. Each file is assigned a GUID when it is indexed by the MediaConvert Service.
	- (read-only) `additional_formats` _(map)_: This is a map that includes the additional media formats generated by the MediaConvert Service. The keys for the map are the resolution of the media (e.g. `1080`, `720`, etc) - see below for structure:
		- `1080` _(map)_: This is the resolution of the additional media format
			- `bucket` _(string)_: S3 bucket of additional media format
			- `key` _(string)_: S3 key of additional media format
		- `720` _(map)_: Additional resolutions are separate maps
			- `bucket` _(string)_: S3 bucket of additional media format
			- `key` _(string)_: S3 key of additional media format
- `created_at` _(string)_: string representation of the initial user product entry (creation) UTC datetime (e.g. "2019-06-10 00:00:00").
- `last_modified` _(string)_: string representation of when the user product entry is updated UTC datetime (e.g. "2019-06-10 00:00:00").

## Notes / TODOs

_This data model is subject to change depending on what technology we moved forward with and how Sounds True wants to handle updloads._

## JSON Representation (with example values) (minus comments)

_**NOTE:** The following is a representation of a **single** Media Metadata object._
```jsonc
{
	"product_sku": "AF04734W",  // primary key
	"file_data": [
		{
			"title": "Ray Table of Contents AF04734W",
			"media_type": "MEDIA_TYPE_PDF",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Ray-Table-of-Contents-AF04734W.pdf",
			"duration": 0,
			"total_pages": 0,
			"file_size": "854.96 KB",
			"sort_order": 1,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae983"
		},
		{
			"title": "Introduction to Session One",
			"media_type": "MEDIA_TYPE_MP3",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Reginald_A_Ray-Somatic_Descent-0101.mp3",
			"duration": 14400,
			"total_pages": 0,
			"file_size": "2.11 MB",
			"sort_order": 10,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae984"
		},
		{
			"title": "The body as sacred source",
			"media_type": "MEDIA_TYPE_MP3",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Reginald_A_Ray-Somatic_Descent-0102.mp3",
			"duration": 14400,
			"total_pages": 0,
			"file_size": "26.34 MB",
			"sort_order": 20,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae985"
		},
		{
			"title": "Turning over the agency of our lives to the Soma",
			"media_type": "MEDIA_TYPE_MP3",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Reginald_A_Ray-Somatic_Descent-0103.mp3",
			"duration": 14400,
			"total_pages": 0,
			"file_size": "15.69 MB",
			"sort_order": 30,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae986"
		},
		{
			"title": "Somatic Descent",
			"media_type": "MEDIA_TYPE_MP4",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Somatic_Descent.m4b",
			"duration": 72000,
			"total_pages": 0,
			"file_size": "1.58 GB",
			"sort_order": 870,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae987",
			"additional_formats": {
				"1080": {
					"bucket": "soundstrue-downloads",
					"key": "products/SomaticDescent_AF04734W/Somatic_Descent_1080.m4b"
				},
				"720" {
					"bucket": "soundstrue-downloads",
					"key": "products/SomaticDescent_AF04734W/Somatic_Descent_720.m4b"
				}
			}
		},
		// ...
		{
			"title": "Somatic Descent",
			"media_type": "MEDIA_TYPE_ZIP",
			"media_s3_bucket": "soundstrue-downloads",
			"media_s3_key": "products/SomaticDescent_AF04734W/Somatic_Descent.zip",
			"duration": 0,
			"total_pages": 0,
			"file_size": "1.65 GB",
			"sort_order": 880,
			"guid": "dd3ea75c-6e08-4424-aecd-b01ec96ae988"
		}
	],
	"created_at": "2019-06-10 00:00:00",
	"last_modified": "2019-06-10 00:00:00"
}
```